import numpy as np
import pandas as pd
import cv2


def mask2rle(img):
    '''
    img: numpy array, 1 - mask, 0 - background
    Returns run length as string formated
    '''
    pixels = img.T.flatten()
    pixels = np.concatenate([[0], pixels, [0]])
    runs = np.where(pixels[1:] != pixels[:-1])[0] + 1
    runs[1::2] -= runs[::2]
    return ' '.join(str(x) for x in runs)


def post_process(probability, threshold, min_size, fill_up=False):
    '''Post processing of each predicted mask, components with lesser number of pixels
    than `min_size` are ignored'''
    mask = cv2.threshold(probability, threshold, 1, cv2.THRESH_BINARY)[1]

    num_component, component = cv2.connectedComponents(mask.astype(np.uint8))
    predictions = np.zeros((256, 1600), np.uint8)
    for c in range(1, num_component):
        p = (component == c)
        if p.sum() > min_size:
            predictions[p] = 1

    # experiments
    if fill_up:
        contours, _ = cv2.findContours(predictions, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
        filled_up_predictions = np.zeros((256, 1600), np.uint8)
        for c in contours:
            cv2.drawContours(filled_up_predictions, [c], 0, 1, -1)
        predictions = filled_up_predictions

    # dilation
    # kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (5, 5))  # RECT, ELLIPSE, CROSS
    # predictions = cv2.dilate(predictions, kernel, iterations=1)

    return predictions


final = np.load('final_191024a.npy')
nonmissing_cls_output = np.load('nonmissing_cls_output_191024a.npy')
nonmissing_fnames = ['00bbcd9af.jpg', '0109b68ec.jpg', '010ec96b4.jpg', '01b47d973.jpg', '01d49cd47.jpg', '0280c72a9.jpg', '037e7564c.jpg', '0384b28ff.jpg', '04922a23f.jpg', '04e78fd86.jpg', '059750041.jpg', '05cb27a3f.jpg', '06708f73c.jpg', '0693ae6fd.jpg', '0783111db.jpg', '0793dde4e.jpg', '080a44c75.jpg', '096e7338a.jpg', '096fa2f7c.jpg', '09a71e9c9.jpg', '09b7a2ac8.jpg', '0a2c9f2e5.jpg', '0a2dbbb6f.jpg', '0a3962685.jpg', '0a63f7765.jpg', '0a9cbb927.jpg', '0ad9a817d.jpg', '0b2f0a191.jpg', '0b2fcc8a7.jpg', '0bd004c2d.jpg', '0bdfd29ba.jpg', '0c124b96b.jpg', '0c8d438af.jpg', '0caaaab31.jpg', '0cca51b4a.jpg', '0ccde8827.jpg', '0d0491e30.jpg', '0da22916c.jpg', '0e39b3fcc.jpg', '0e6b42f13.jpg', '0ef839b31.jpg', '0f3308225.jpg', '0f3a8491e.jpg', '0fa2f1fa2.jpg', '0fbc1597c.jpg', '100608ebe.jpg', '1014ae8b8.jpg', '10d64f676.jpg', '10e3e1ae2.jpg', '110caee87.jpg', '1134a8e6b.jpg', '115a301e7.jpg', '1160c4155.jpg', '1179d7767.jpg', '1197190fe.jpg', '1200683b1.jpg', '133fe40b6.jpg', '1374fecc2.jpg', '13b049f6e.jpg', '1445d5ab6.jpg', '147a1b7ac.jpg', '159bb4951.jpg', '15bf62435.jpg', '15c5d6e68.jpg', '15e92a657.jpg', '15f36c028.jpg', '16070626a.jpg', '162959249.jpg', '165be877c.jpg', '16b4b381f.jpg', '16e5cabec.jpg', '179a5ea0b.jpg', '17f6716dd.jpg', '1800f04df.jpg', '183a346ed.jpg', '1859bb7f6.jpg', '19439013c.jpg', '195bf8a80.jpg', '19c0e7a52.jpg', '1a4836303.jpg', '1a9b84f4a.jpg', '1b246801d.jpg', '1ba63ec01.jpg', '1bbf4b4c0.jpg', '1bdc31ef8.jpg', '1cb3a9f21.jpg', '1cdc0358f.jpg', '1d52eb20c.jpg', '1d617527f.jpg', '1ddca477a.jpg', '1e2a28cae.jpg', '1e446e941.jpg', '1e8f59c7e.jpg', '1ed7c09f2.jpg', '1ef19628e.jpg', '1f6d91f6c.jpg', '1fee22ffe.jpg', '205522c82.jpg', '2080d4f8d.jpg', '211af4a0f.jpg', '21585a8d1.jpg', '216f0c026.jpg', '21875726a.jpg', '21e28f2e5.jpg', '2233caaaf.jpg', '2235e045d.jpg', '225028fc0.jpg', '2262f1399.jpg', '2338c3671.jpg', '234198d88.jpg', '2363573c7.jpg', '23949cda8.jpg', '23e0d228d.jpg', '23e3f9870.jpg', '243bdc490.jpg', '24810ee2c.jpg', '24b541e55.jpg', '2511baed5.jpg', '2523fef1b.jpg', '256aeb46a.jpg', '25a1d91d4.jpg', '26306db43.jpg', '269431f85.jpg', '26a2f9809.jpg', '26d4c1c22.jpg', '272e97e63.jpg', '273d5bd8b.jpg', '274004b27.jpg', '278b20cb1.jpg', '280e93616.jpg', '28138ebf2.jpg', '2819eaa18.jpg', '288d92035.jpg', '28ae995da.jpg', '2a17f8fed.jpg', '2a5cc5f58.jpg', '2a830069f.jpg', '2a9352386.jpg', '2b75eb7ae.jpg', '2beb4de91.jpg', '2c0eea9dc.jpg', '2c29f8e2d.jpg', '2ce89fa13.jpg', '2d2474be8.jpg', '2d8fa3ef6.jpg', '2dba99f31.jpg', '2e1014fb7.jpg', '2eb1e6465.jpg', '2eb811b0c.jpg', '2f502ea2a.jpg', '2f97adb98.jpg', '2fed1cf68.jpg', '3034c8ebf.jpg', '304b3bdb8.jpg', '30a55717f.jpg', '30b549e48.jpg', '311a6b255.jpg', '312357e32.jpg', '31402958a.jpg', '318ce3987.jpg', '31f8b702a.jpg', '3228d8997.jpg', '328e3c209.jpg', '32c27e65f.jpg', '334b5fd37.jpg', '335d78292.jpg', '33605817c.jpg', '338b4c181.jpg', '33d296fef.jpg', '33e30b75b.jpg', '33fd0c742.jpg', '349fee110.jpg', '351c55d38.jpg', '352f722e4.jpg', '3550242ec.jpg', '35544c8c1.jpg', '356cd7089.jpg', '358c4e6ce.jpg', '35f50a445.jpg', '363f4106f.jpg', '3661ccb2d.jpg', '369947a71.jpg', '369fd8e23.jpg', '372e173f7.jpg', '3730c15d7.jpg', '37319d9cc.jpg', '37368759e.jpg', '3736d042c.jpg', '3752425f7.jpg', '378272756.jpg', '38b9631df.jpg', '38e89262f.jpg', '392be1c76.jpg', '3963aac50.jpg', '3a1ee3897.jpg', '3a75cf4ec.jpg', '3ac931a18.jpg', '3acf04349.jpg', '3b3687032.jpg', '3b6c36185.jpg', '3b6f6868f.jpg', '3b7b7ceaf.jpg', '3b7e44715.jpg', '3c6854422.jpg', '3c93807f4.jpg', '3c9691d0c.jpg', '3cc137693.jpg', '3cee96935.jpg', '3cfa60f2d.jpg', '3cfda2739.jpg', '3d060ac2d.jpg', '3da41c9f0.jpg', '3dac7e059.jpg', '3de4313ab.jpg', '3df222f6a.jpg', '3e1b9d319.jpg', '3e430ace5.jpg', '3e6c0f7a4.jpg', '3ecd7753b.jpg', '3f0e0a371.jpg', '3f17e4acc.jpg', '3f6145c7d.jpg', '3f62cb71d.jpg', '3f9314e1d.jpg', '3fcbe5470.jpg', '418b7376c.jpg', '418bf2729.jpg', '41f81f578.jpg', '421f6e318.jpg', '4223116c6.jpg', '424b57fbe.jpg', '42636127e.jpg', '42d4d28f6.jpg', '43a10ca4f.jpg', '43be155b2.jpg', '43c1a4a70.jpg', '43cdf7d8d.jpg', '43fe37865.jpg', '445a4f77f.jpg', '44859b1b9.jpg', '448a73204.jpg', '4490e43c1.jpg', '44aca2961.jpg', '44bbde24d.jpg', '44ca85273.jpg', '454d8aab4.jpg', '456241aa5.jpg', '457e96b39.jpg', '45b112be2.jpg', '46d2424e8.jpg', '47608300f.jpg', '4778df12c.jpg', '47c1a0f4a.jpg', '47c9178a3.jpg', '48786fbac.jpg', '48994af29.jpg', '48c23125e.jpg', '49289e055.jpg', '492f6c44a.jpg', '499e41bff.jpg', '49b1c08c6.jpg', '49d7ee139.jpg', '4a84c317a.jpg', '4ad8ea918.jpg', '4aea81288.jpg', '4b6d44881.jpg', '4c3feb803.jpg', '4c5671c92.jpg', '4c63aa5c5.jpg', '4c7d0c617.jpg', '4c805698a.jpg', '4ce6b0ff9.jpg', '4d33bf863.jpg', '4d429c29f.jpg', '4dde69bdb.jpg', '4e0891122.jpg', '4e5c4ab98.jpg', '4e6339bd8.jpg', '4e8309017.jpg', '4f84396bf.jpg', '4fd6d8734.jpg', '4fdd51899.jpg', '512652b4f.jpg', '5144b32b4.jpg', '517fffea8.jpg', '52bef8669.jpg', '53660ffd5.jpg', '53ffd9993.jpg', '5406c01d7.jpg', '541e5bfec.jpg', '544f5beba.jpg', '54a757589.jpg', '54d3df55b.jpg', '5500d78ed.jpg', '555917097.jpg', '559759f28.jpg', '559aceb9e.jpg', '55b9d15d5.jpg', '56bdb9e3c.jpg', '56d3153f9.jpg', '56d707102.jpg', '573d1f811.jpg', '574f43979.jpg', '57cabd349.jpg', '5895de1c3.jpg', '589dd7157.jpg', '58f22628e.jpg', '595426f59.jpg', '59c0a3475.jpg', '5a7c94126.jpg', '5a9149cad.jpg', '5ae4f1314.jpg', '5b4743e28.jpg', '5bbf5aa3f.jpg', '5c0dade54.jpg', '5c6d48548.jpg', '5c6fdc38e.jpg', '5c9df14bd.jpg', '5d304901c.jpg', '5d80961c1.jpg', '5d990dafc.jpg', '5da555152.jpg', '5da5cbfac.jpg', '5e049970d.jpg', '5e23a5dd3.jpg', '5e2e9fbed.jpg', '5ef5a701c.jpg', '5f1308e91.jpg', '5f2f8397d.jpg', '5f627b6b6.jpg', '5f9e63b94.jpg', '5ff740a19.jpg', '60dc13c8f.jpg', '611f72ff8.jpg', '61243b268.jpg', '61fc6d361.jpg', '61ffc10bd.jpg', '63061a1ca.jpg', '632d55c7c.jpg', '63e8fd4d7.jpg', '64d1f29e0.jpg', '64e741b4d.jpg', '650dc1057.jpg', '656b2014f.jpg', '657bc3dab.jpg', '6583c7755.jpg', '65bb87731.jpg', '65de19b8e.jpg', '666567e46.jpg', '668fed093.jpg', '670dda82e.jpg', '674544933.jpg', '67a345551.jpg', '67f3733e1.jpg', '67fd6ce4d.jpg', '681775be8.jpg', '68afa072c.jpg', '68d1c6f63.jpg', '690fbb138.jpg', '69d2fe769.jpg', '69d9e3b5b.jpg', '6a38180d6.jpg', '6a45da8e9.jpg', '6ad0e93f3.jpg', '6b414548c.jpg', '6b9d0b108.jpg', '6c4b43ee0.jpg', '6c9db53a5.jpg', '6d0bcc474.jpg', '6d1b0740c.jpg', '6d422b814.jpg', '6d422d496.jpg', '6d5731630.jpg', '6d841409e.jpg', '6d876bc2f.jpg', '6dc0f0256.jpg', '6e0a0050c.jpg', '6e1715d95.jpg', '6e33e7465.jpg', '6eb8caa4a.jpg', '6ec0efcf3.jpg', '6eec49a0b.jpg', '6f12a26e0.jpg', '6f88c6d64.jpg', '6fa8c306d.jpg', '6fc70467c.jpg', '6fd029d4d.jpg', '6fdb86bdf.jpg', '7081b8507.jpg', '7146e52ed.jpg', '714f9d00b.jpg', '719090053.jpg', '71f8c87bd.jpg', '71fa60ddf.jpg', '72341723f.jpg', '7286d03ef.jpg', '72ed9c3d8.jpg', '732f9ff8b.jpg', '735aed3ac.jpg', '73779d0e5.jpg', '7392cb034.jpg', '73aef6a73.jpg', '73ff8efef.jpg', '74f951ca4.jpg', '7521c2550.jpg', '758437094.jpg', '75b24ab86.jpg', '75e4cf240.jpg', '75efd5e42.jpg', '75f0c1e00.jpg', '760aae1ec.jpg', '76288fc9c.jpg', '762d825cd.jpg', '768e90b47.jpg', '76ee7f36f.jpg', '77005f2f4.jpg', '7758e7e93.jpg', '781b78af7.jpg', '782c9966e.jpg', '78e04eec1.jpg', '78fd79c06.jpg', '792038159.jpg', '7963573a1.jpg', '7979e93cd.jpg', '79d9ff869.jpg', '79e309e7b.jpg', '79e6f2b42.jpg', '79ea45aa1.jpg', '7a1986428.jpg', '7a4e42374.jpg', '7a512ca2c.jpg', '7a5288cb8.jpg', '7add4314d.jpg', '7b0435807.jpg', '7b1ed2ad7.jpg', '7b3bb39d1.jpg', '7b455e37c.jpg', '7b8ac2c44.jpg', '7bed4da05.jpg', '7bfa422df.jpg', '7c1543f80.jpg', '7c46d8f79.jpg', '7c5534db1.jpg', '7cc1fb6ee.jpg', '7cccf944b.jpg', '7cd146e5e.jpg', '7cd86fd14.jpg', '7cda61a73.jpg', '7e104caad.jpg', '7e8904c22.jpg', '7eb199869.jpg', '7f1d3ec5e.jpg', '7f9ea512e.jpg', '80111d56e.jpg', '80657f706.jpg', '808359bda.jpg', '80cbe5d35.jpg', '80d489d3f.jpg', '80d4f7a25.jpg', '817d399e2.jpg', '8187f1b45.jpg', '81a5138eb.jpg', '81da020a0.jpg', '830ebda8b.jpg', '83325a620.jpg', '837f2703c.jpg', '83926cb04.jpg', '83a0dbb43.jpg', '83a187036.jpg', '83aa61a19.jpg', '846fff7a8.jpg', '8475899d7.jpg', '84e348664.jpg', '86d73c437.jpg', '86fe3cf8c.jpg', '874f5fe53.jpg', '87c5bbcba.jpg', '87f4645ee.jpg', '8827f75d2.jpg', '884488d16.jpg', '88afdeeb8.jpg', '88bfc04e8.jpg', '88cacaf33.jpg', '8973e4e91.jpg', '89977988b.jpg', '89a629daa.jpg', '8a5484d4d.jpg', '8b08c23f0.jpg', '8bc3d26cb.jpg', '8bd6ef3fb.jpg', '8c50370fe.jpg', '8d40206b1.jpg', '8d5f997f2.jpg', '8d8bd106b.jpg', '8e1cf2257.jpg', '8e4dbe30f.jpg', '8e703053f.jpg', '8f26dbe33.jpg', '8f480a549.jpg', '8ff2bd9f3.jpg', '8ff37df24.jpg', '9056783d7.jpg', '90928cdb6.jpg', '911e86fb7.jpg', '9132d6f86.jpg', '91376eb04.jpg', '91604e4f4.jpg', '9177da79f.jpg', '91a32baec.jpg', '91ef23069.jpg', '92f506757.jpg', '943a908b4.jpg', '944afa4e4.jpg', '9484781db.jpg', '948f0cad1.jpg', '949a1d446.jpg', '94a687dea.jpg', '94b1d0288.jpg', '94c65ec76.jpg', '950487205.jpg', '9520225ec.jpg', '9553248f2.jpg', '9568a10f7.jpg', '958feb050.jpg', '95aa55d7d.jpg', '95dca6ffa.jpg', '95eb51548.jpg', '9676c628e.jpg', '967ecac66.jpg', '96a864d9e.jpg', '96fefb723.jpg', '971cb01d4.jpg', '97880f512.jpg', '980d73519.jpg', '98861ce3b.jpg', '98bae0369.jpg', '98da1cdfd.jpg', '990852160.jpg', '9930cc99a.jpg', '9971b06fb.jpg', '99ced6e4a.jpg', '9aa6cf465.jpg', '9abf4e920.jpg', '9add1b7db.jpg', '9aec02d72.jpg', '9b16a82de.jpg', '9b5147492.jpg', '9b66b8330.jpg', '9c1af32c2.jpg', '9c595e23e.jpg', '9cbc700db.jpg', '9cc10ade1.jpg', '9cd461813.jpg', '9cebc2686.jpg', '9d143b20f.jpg', '9d2b4edf3.jpg', '9e24388bd.jpg', '9ebdc1f1f.jpg', '9f7498252.jpg', '9f7a5b38b.jpg', '9fcc459b7.jpg', '9fef81473.jpg', 'a02e9f525.jpg', 'a07c95dec.jpg', 'a0838ee79.jpg', 'a0b280324.jpg', 'a0c32332a.jpg', 'a0d37c784.jpg', 'a0fd8f9d6.jpg', 'a138d1604.jpg', 'a20204e10.jpg', 'a2423ec13.jpg', 'a29360bc1.jpg', 'a301b86f5.jpg', 'a3849d778.jpg', 'a40c26912.jpg', 'a437f34dc.jpg', 'a44298fe1.jpg', 'a4a2f54f4.jpg', 'a4c9fb612.jpg', 'a4fe1adda.jpg', 'a521ed387.jpg', 'a55578b4c.jpg', 'a5a94ede7.jpg', 'a5e151ad8.jpg', 'a631d53aa.jpg', 'a69f95c48.jpg', 'a7377c95e.jpg', 'a79b53847.jpg', 'a7e803b17.jpg', 'a821909ee.jpg', 'a83fc096c.jpg', 'a8675325e.jpg', 'a873b638e.jpg', 'a8ab0eae9.jpg', 'aa1d1e861.jpg', 'aa604ec06.jpg', 'ab3a9a988.jpg', 'ab730950d.jpg', 'ab7ad60ea.jpg', 'ab9d7104b.jpg', 'abb5bcc54.jpg', 'ac4eb0b7f.jpg', 'aca4c0bf2.jpg', 'ad9471f70.jpg', 'ad9c71145.jpg', 'adab9d36c.jpg', 'add9aa6e6.jpg', 'ae15916ee.jpg', 'ae32bf450.jpg', 'ae3cf9bab.jpg', 'ae429576b.jpg', 'ae831607d.jpg', 'aea7d0dcf.jpg', 'afaafa0e2.jpg', 'afc3e3e90.jpg', 'afec9857d.jpg', 'b0050b626.jpg', 'b03b804f4.jpg', 'b069e70a9.jpg', 'b0b5a3357.jpg', 'b1166a68f.jpg', 'b1648ba07.jpg', 'b1b83ad86.jpg', 'b1c324193.jpg', 'b214b85d0.jpg', 'b2491c424.jpg', 'b2c7e1161.jpg', 'b2fae3494.jpg', 'b371745dc.jpg', 'b388c6de3.jpg', 'b3912fc50.jpg', 'b3a766a95.jpg', 'b3f594ba3.jpg', 'b461a25f2.jpg', 'b4a113603.jpg', 'b4d365c88.jpg', 'b4dfd853c.jpg', 'b506c5877.jpg', 'b51cdf84f.jpg', 'b6427c1f5.jpg', 'b64844bed.jpg', 'b64f40c00.jpg', 'b6d419268.jpg', 'b6db2946b.jpg', 'b6edd61b7.jpg', 'b7018c2a5.jpg', 'b760debb1.jpg', 'b98946867.jpg', 'b991340c8.jpg', 'ba4168e4d.jpg', 'ba8ebb757.jpg', 'bb131c78e.jpg', 'bb13a714f.jpg', 'bb3ed626f.jpg', 'bb5322eae.jpg', 'bbc5bbff4.jpg', 'bbe2bd39d.jpg', 'bc34d04f1.jpg', 'bc6d00672.jpg', 'bcc1fd0e4.jpg', 'bcf7d4b9a.jpg', 'bcf8c8739.jpg', 'bd96c3707.jpg', 'bd9de1aa3.jpg', 'bdb1f5a68.jpg', 'bddb8e7c7.jpg', 'be16b3bd7.jpg', 'be6f60f41.jpg', 'be76e9ca7.jpg', 'bee40f5e8.jpg', 'bf275fe13.jpg', 'bf537d326.jpg', 'c0473efc0.jpg', 'c0bd7fecd.jpg', 'c1c3f9072.jpg', 'c1e1e7b0c.jpg', 'c224552e0.jpg', 'c234bf0a0.jpg', 'c2b52f420.jpg', 'c367c6133.jpg', 'c37e5676c.jpg', 'c3db04098.jpg', 'c3f9989d5.jpg', 'c43fd3530.jpg', 'c4405bef9.jpg', 'c4617b332.jpg', 'c4987c901.jpg', 'c521ad2a6.jpg', 'c55581dff.jpg', 'c57bbee34.jpg', 'c5bd13a82.jpg', 'c6bc7ca4b.jpg', 'c6f648543.jpg', 'c716d86d5.jpg', 'c723f1ada.jpg', 'c725bafda.jpg', 'c7335eee0.jpg', 'c759436cd.jpg', 'c8144de93.jpg', 'c82561e06.jpg', 'c8311ec86.jpg', 'c86f91dbf.jpg', 'c8f2d68aa.jpg', 'c91c10abe.jpg', 'c93217423.jpg', 'c96562a3f.jpg', 'c9737bd79.jpg', 'c9ca9769f.jpg', 'c9e2ce466.jpg', 'caf4103e1.jpg', 'cb17da791.jpg', 'cb241fa5d.jpg', 'cb28e4857.jpg', 'cba3fdc7a.jpg', 'cbb1d7ff5.jpg', 'cc069dc99.jpg', 'cc6e5e804.jpg', 'cc9ddbc17.jpg', 'ccb799c73.jpg', 'cd17f385a.jpg', 'cd75780c0.jpg', 'cde486dbf.jpg', 'cdfb634a5.jpg', 'ce1c08011.jpg', 'ce6170a7f.jpg', 'cf0483836.jpg', 'cf06b295a.jpg', 'cf075fd69.jpg', 'd04a7fb6c.jpg', 'd0793e6b2.jpg', 'd0cee7515.jpg', 'd18e48954.jpg', 'd1ae5708a.jpg', 'd1d054d6f.jpg', 'd22364fb6.jpg', 'd249e6983.jpg', 'd25120582.jpg', 'd3801de15.jpg', 'd42853714.jpg', 'd42d5725e.jpg', 'd4a0cb9af.jpg', 'd4ac8538b.jpg', 'd5137b6f8.jpg', 'd52fefa0f.jpg', 'd5ae74330.jpg', 'd5bbdc8a8.jpg', 'd5e8bbe9a.jpg', 'd5fab51f7.jpg', 'd6128fbfc.jpg', 'd6377dc32.jpg', 'd6677e1ff.jpg', 'd670249ed.jpg', 'd67e52625.jpg', 'd6cba7ed9.jpg', 'd704ab756.jpg', 'd7741a3ba.jpg', 'd8129a060.jpg', 'd838ab96a.jpg', 'd866b5d5c.jpg', 'd8f8075c8.jpg', 'da6cce90a.jpg', 'da891d3af.jpg', 'dab41427c.jpg', 'dae47b14e.jpg', 'db6a9172c.jpg', 'db758d243.jpg', 'dbfc43562.jpg', 'dc2205ab2.jpg', 'dc89301ff.jpg', 'dc8d040ab.jpg', 'dd4531cef.jpg', 'dd9364137.jpg', 'ddca8eddd.jpg', 'de2df260c.jpg', 'de5881c2b.jpg', 'de7556be9.jpg', 'dec5aa06a.jpg', 'dedf68f1e.jpg', 'def7d77bd.jpg', 'defe590d5.jpg', 'df0facbbd.jpg', 'df6767e85.jpg', 'dfb1ab260.jpg', 'dfc265237.jpg', 'e01b0d22c.jpg', 'e07986242.jpg', 'e0b422958.jpg', 'e0d3ed478.jpg', 'e0f059688.jpg', 'e1090545d.jpg', 'e16b5476a.jpg', 'e237a3954.jpg', 'e30317c29.jpg', 'e30e861c8.jpg', 'e31cb8391.jpg', 'e380b37ba.jpg', 'e391fbf7c.jpg', 'e397fcb9c.jpg', 'e4168f460.jpg', 'e4612d7c4.jpg', 'e49ca4ccc.jpg', 'e55cdcaaf.jpg', 'e57a18b8f.jpg', 'e5803c399.jpg', 'e5c133bf8.jpg', 'e5c597eca.jpg', 'e61b83be0.jpg', 'e62ab86cd.jpg', 'e7c0e2635.jpg', 'e80bc63e0.jpg', 'e83b28579.jpg', 'e89125653.jpg', 'e89a4ca99.jpg', 'e8a1e41ef.jpg', 'e904c0dc2.jpg', 'e968f8497.jpg', 'e9d339446.jpg', 'ea8c1f361.jpg', 'eab87e269.jpg', 'eacf21af0.jpg', 'ec0e63edf.jpg', 'ec1e848f0.jpg', 'ec44edc94.jpg', 'ec6132d16.jpg', 'ec6434bac.jpg', 'ec7ab4de4.jpg', 'ec96e3f18.jpg', 'ecdcdfc6d.jpg', 'edfba47f3.jpg', 'ee047d59d.jpg', 'ee6666c5c.jpg', 'ef4b7c6be.jpg', 'ef5bd0f19.jpg', 'ef84d8825.jpg', 'ef8e8852a.jpg', 'ef963aadc.jpg', 'efb9face0.jpg', 'efc0006fa.jpg', 'f04c7c5ac.jpg', 'f0842d221.jpg', 'f0fa65d89.jpg', 'f1338af36.jpg', 'f14eb3bba.jpg', 'f1d90c01a.jpg', 'f1d98dffe.jpg', 'f1ff7d363.jpg', 'f2313afbd.jpg', 'f246790fc.jpg', 'f25152812.jpg', 'f3e31ebb4.jpg', 'f3e43b28e.jpg', 'f4ac9794b.jpg', 'f50a536c6.jpg', 'f550b3e1b.jpg', 'f605a77df.jpg', 'f625f93a1.jpg', 'f779cc81a.jpg', 'f7c7e853c.jpg', 'f7e741823.jpg', 'f7f2c2817.jpg', 'f80ed5101.jpg', 'f82d83496.jpg', 'f83e863db.jpg', 'f89ea01f9.jpg', 'f8e1d1d25.jpg', 'f947a5bf6.jpg', 'f948cddb2.jpg', 'f98450a9d.jpg', 'f99381ed5.jpg', 'f9a5b9bea.jpg', 'f9c2ebdcf.jpg', 'f9ccc4b77.jpg', 'f9d438665.jpg', 'fa2a43fe9.jpg', 'fa32469ab.jpg', 'fa52724c1.jpg', 'fa5900edc.jpg', 'fb47d1546.jpg', 'fb878c641.jpg', 'fb8870b74.jpg', 'fbca0c4fb.jpg', 'fc1a8fe78.jpg', 'fc1dae347.jpg', 'fc214bcbc.jpg', 'fc28f7fe0.jpg', 'fc3c8279e.jpg', 'fc3ec57fb.jpg', 'fc6ec9b13.jpg', 'fc9258351.jpg', 'fc9b9483f.jpg', 'fca5873cd.jpg', 'fd63c350a.jpg', 'fe03f768e.jpg', 'fe3116441.jpg', 'fe7315df8.jpg', 'ff18d8aa8.jpg', 'ff4d29e0d.jpg', 'ffa10f6f3.jpg', 'ffaf13d96.jpg', 'ffbf79783.jpg', 'ffdb60677.jpg']
print(len(nonmissing_fnames))
# nonmissing_fnames = ['00bbcd9af.jpg', '0109b68ec.jpg', '010ec96b4.jpg', '01b47d973.jpg', '01d49cd47.jpg', '0280c72a9.jpg', '037e7564c.jpg', '0384b28ff.jpg', '04922a23f.jpg', '04e78fd86.jpg', '059750041.jpg', '05cb27a3f.jpg', '06708f73c.jpg', '0693ae6fd.jpg', '0783111db.jpg', '0793dde4e.jpg', '080a44c75.jpg', '096e7338a.jpg', '096fa2f7c.jpg', '09a71e9c9.jpg', '09b7a2ac8.jpg', '09c5e376e.jpg', '0a2c9f2e5.jpg', '0a2dbbb6f.jpg', '0a3962685.jpg', '0a63f7765.jpg', '0a9cbb927.jpg', '0ad9a817d.jpg', '0b2f0a191.jpg', '0b2fcc8a7.jpg', '0bd004c2d.jpg', '0bdfd29ba.jpg', '0c124b96b.jpg', '0c8d438af.jpg', '0caaaab31.jpg', '0cca51b4a.jpg', '0ccde8827.jpg', '0d0491e30.jpg', '0da22916c.jpg', '0e2adcd02.jpg', '0e39b3fcc.jpg', '0e6b42f13.jpg', '0ef839b31.jpg', '0f3308225.jpg', '0f3a8491e.jpg', '0fa2f1fa2.jpg', '0fbc1597c.jpg', '100608ebe.jpg', '1014ae8b8.jpg', '10d64f676.jpg', '10e3e1ae2.jpg', '110caee87.jpg', '1134a8e6b.jpg', '115a301e7.jpg', '1160c4155.jpg', '1179d7767.jpg', '1197190fe.jpg', '1200683b1.jpg', '133fe40b6.jpg', '1374fecc2.jpg', '13b049f6e.jpg', '1445d5ab6.jpg', '147a1b7ac.jpg', '159bb4951.jpg', '15bf62435.jpg', '15c5d6e68.jpg', '15e92a657.jpg', '15f36c028.jpg', '16070626a.jpg', '162959249.jpg', '165be877c.jpg', '16b4b381f.jpg', '16e5cabec.jpg', '179a5ea0b.jpg', '17f6716dd.jpg', '1800f04df.jpg', '183a346ed.jpg', '1859bb7f6.jpg', '19439013c.jpg', '195bf8a80.jpg', '19c0e7a52.jpg', '1a4836303.jpg', '1a9b84f4a.jpg', '1b246801d.jpg', '1ba63ec01.jpg', '1bbf4b4c0.jpg', '1bdc31ef8.jpg', '1cb3a9f21.jpg', '1cdc0358f.jpg', '1d52eb20c.jpg', '1d617527f.jpg', '1ddca477a.jpg', '1e2a28cae.jpg', '1e446e941.jpg', '1e8f59c7e.jpg', '1ed7c09f2.jpg', '1ef19628e.jpg', '1f6d91f6c.jpg', '1fee22ffe.jpg', '205522c82.jpg', '2080d4f8d.jpg', '211af4a0f.jpg', '21585a8d1.jpg', '216f0c026.jpg', '21875726a.jpg', '21e28f2e5.jpg', '2233caaaf.jpg', '2235e045d.jpg', '225028fc0.jpg', '2262f1399.jpg', '228137fed.jpg', '2338c3671.jpg', '234198d88.jpg', '2363573c7.jpg', '23949cda8.jpg', '23e0d228d.jpg', '23e3f9870.jpg', '243bdc490.jpg', '24810ee2c.jpg', '24b541e55.jpg', '2511baed5.jpg', '2523fef1b.jpg', '256aeb46a.jpg', '25a1d91d4.jpg', '25c5fe53a.jpg', '26306db43.jpg', '269431f85.jpg', '26a2f9809.jpg', '26d4c1c22.jpg', '272e97e63.jpg', '273d5bd8b.jpg', '274004b27.jpg', '278b20cb1.jpg', '280e93616.jpg', '28138ebf2.jpg', '2819eaa18.jpg', '288d92035.jpg', '28ae995da.jpg', '2a17f8fed.jpg', '2a5cc5f58.jpg', '2a830069f.jpg', '2a9352386.jpg', '2b75eb7ae.jpg', '2beb4de91.jpg', '2c0eea9dc.jpg', '2c29f8e2d.jpg', '2c6df432d.jpg', '2ce89fa13.jpg', '2d2474be8.jpg', '2d8fa3ef6.jpg', '2dba99f31.jpg', '2e1014fb7.jpg', '2e5393458.jpg', '2eb1e6465.jpg', '2eb811b0c.jpg', '2f502ea2a.jpg', '2f97adb98.jpg', '2fed1cf68.jpg', '3034c8ebf.jpg', '304b3bdb8.jpg', '30a55717f.jpg', '30b549e48.jpg', '311a6b255.jpg', '312357e32.jpg', '31402958a.jpg', '318ce3987.jpg', '31f8b702a.jpg', '3228d8997.jpg', '328e3c209.jpg', '32c27e65f.jpg', '334b5fd37.jpg', '335d78292.jpg', '33605817c.jpg', '338b4c181.jpg', '33d296fef.jpg', '33e30b75b.jpg', '33fd0c742.jpg', '349fee110.jpg', '351c55d38.jpg', '352f722e4.jpg', '3550242ec.jpg', '35544c8c1.jpg', '356cd7089.jpg', '358c4e6ce.jpg', '35f50a445.jpg', '363f4106f.jpg', '3661ccb2d.jpg', '369947a71.jpg', '369fd8e23.jpg', '372e173f7.jpg', '3730c15d7.jpg', '37319d9cc.jpg', '37368759e.jpg', '3736d042c.jpg', '3752425f7.jpg', '378272756.jpg', '38b9631df.jpg', '38e89262f.jpg', '392be1c76.jpg', '3963aac50.jpg', '3a1ee3897.jpg', '3a75cf4ec.jpg', '3ac931a18.jpg', '3acf04349.jpg', '3b3687032.jpg', '3b6c36185.jpg', '3b6f6868f.jpg', '3b7b7ceaf.jpg', '3b7e44715.jpg', '3bf50913b.jpg', '3c6854422.jpg', '3c93807f4.jpg', '3c9691d0c.jpg', '3cc137693.jpg', '3cee96935.jpg', '3cfa60f2d.jpg', '3cfda2739.jpg', '3d060ac2d.jpg', '3da41c9f0.jpg', '3dac7e059.jpg', '3de4313ab.jpg', '3df222f6a.jpg', '3e1b9d319.jpg', '3e430ace5.jpg', '3e6c0f7a4.jpg', '3ecd7753b.jpg', '3f0e0a371.jpg', '3f17e4acc.jpg', '3f6145c7d.jpg', '3f62cb71d.jpg', '3f9314e1d.jpg', '3fcbe5470.jpg', '418b7376c.jpg', '418bf2729.jpg', '41f81f578.jpg', '421f6e318.jpg', '4223116c6.jpg', '424b57fbe.jpg', '42636127e.jpg', '42d4d28f6.jpg', '42f269efe.jpg', '43a10ca4f.jpg', '43be155b2.jpg', '43c1a4a70.jpg', '43cdf7d8d.jpg', '43fe37865.jpg', '445a4f77f.jpg', '44859b1b9.jpg', '448a73204.jpg', '4490e43c1.jpg', '44aca2961.jpg', '44bbde24d.jpg', '44ca85273.jpg', '454d8aab4.jpg', '456241aa5.jpg', '457e96b39.jpg', '45b112be2.jpg', '45da4ba4e.jpg', '46d2424e8.jpg', '47608300f.jpg', '4778df12c.jpg', '47c1a0f4a.jpg', '47c9178a3.jpg', '48786fbac.jpg', '48994af29.jpg', '48c23125e.jpg', '49289e055.jpg', '492f6c44a.jpg', '499e41bff.jpg', '49b1c08c6.jpg', '49d7ee139.jpg', '4a84c317a.jpg', '4ad8ea918.jpg', '4aea81288.jpg', '4b6d44881.jpg', '4c3feb803.jpg', '4c5671c92.jpg', '4c63aa5c5.jpg', '4c7d0c617.jpg', '4c805698a.jpg', '4ce6b0ff9.jpg', '4d33bf863.jpg', '4d429c29f.jpg', '4dde69bdb.jpg', '4e0891122.jpg', '4e5c4ab98.jpg', '4e6339bd8.jpg', '4e8309017.jpg', '4f84396bf.jpg', '4fd6d8734.jpg', '4fdd51899.jpg', '512652b4f.jpg', '5144b32b4.jpg', '517fffea8.jpg', '52bef8669.jpg', '53660ffd5.jpg', '53ffd9993.jpg', '5406c01d7.jpg', '541e5bfec.jpg', '544f5beba.jpg', '54a757589.jpg', '54d3df55b.jpg', '5500d78ed.jpg', '555917097.jpg', '559759f28.jpg', '559aceb9e.jpg', '55b9d15d5.jpg', '56bdb9e3c.jpg', '56d3153f9.jpg', '56d707102.jpg', '573d1f811.jpg', '574f43979.jpg', '57cabd349.jpg', '5895de1c3.jpg', '589dd7157.jpg', '58f22628e.jpg', '595426f59.jpg', '59c0a3475.jpg', '5a7c94126.jpg', '5a9149cad.jpg', '5aa3780c6.jpg', '5ae4f1314.jpg', '5b4743e28.jpg', '5bbf5aa3f.jpg', '5c0dade54.jpg', '5c6d48548.jpg', '5c6fdc38e.jpg', '5c9df14bd.jpg', '5d304901c.jpg', '5d80961c1.jpg', '5d990dafc.jpg', '5da555152.jpg', '5da5cbfac.jpg', '5e049970d.jpg', '5e23a5dd3.jpg', '5e2e9fbed.jpg', '5ef5a701c.jpg', '5f1308e91.jpg', '5f2f8397d.jpg', '5f627b6b6.jpg', '5f9e63b94.jpg', '5ff740a19.jpg', '60dc13c8f.jpg', '611f72ff8.jpg', '61243b268.jpg', '61fc6d361.jpg', '61ffc10bd.jpg', '63061a1ca.jpg', '632d55c7c.jpg', '63e8fd4d7.jpg', '64a5153e0.jpg', '64d1f29e0.jpg', '64e741b4d.jpg', '650dc1057.jpg', '656b2014f.jpg', '657bc3dab.jpg', '6583c7755.jpg', '65bb87731.jpg', '65de19b8e.jpg', '666567e46.jpg', '668fed093.jpg', '670dda82e.jpg', '674544933.jpg', '67a345551.jpg', '67f3733e1.jpg', '67fd6ce4d.jpg', '681775be8.jpg', '68281b5f0.jpg', '68afa072c.jpg', '68d1c6f63.jpg', '690fbb138.jpg', '69d2fe769.jpg', '69d9e3b5b.jpg', '6a38180d6.jpg', '6a45da8e9.jpg', '6ad0e93f3.jpg', '6b414548c.jpg', '6b9d0b108.jpg', '6c4b43ee0.jpg', '6c9db53a5.jpg', '6d0bcc474.jpg', '6d1b0740c.jpg', '6d422b814.jpg', '6d422d496.jpg', '6d5731630.jpg', '6d841409e.jpg', '6d876bc2f.jpg', '6dc0f0256.jpg', '6e0a0050c.jpg', '6e1715d95.jpg', '6e33e7465.jpg', '6eb8caa4a.jpg', '6ec0efcf3.jpg', '6eec49a0b.jpg', '6f12a26e0.jpg', '6f88c6d64.jpg', '6fa8c306d.jpg', '6fc70467c.jpg', '6fd029d4d.jpg', '6fdb86bdf.jpg', '7081b8507.jpg', '7146e52ed.jpg', '714f9d00b.jpg', '719090053.jpg', '71f8c87bd.jpg', '71fa60ddf.jpg', '72341723f.jpg', '7286d03ef.jpg', '72ed9c3d8.jpg', '732f9ff8b.jpg', '735aed3ac.jpg', '73779d0e5.jpg', '7392cb034.jpg', '73aef6a73.jpg', '73ff8efef.jpg', '74f951ca4.jpg', '7521c2550.jpg', '758437094.jpg', '75b24ab86.jpg', '75e4cf240.jpg', '75efd5e42.jpg', '75f0c1e00.jpg', '760aae1ec.jpg', '76288fc9c.jpg', '762d825cd.jpg', '768e90b47.jpg', '76ee7f36f.jpg', '77005f2f4.jpg', '7758e7e93.jpg', '781b78af7.jpg', '782c9966e.jpg', '78e04eec1.jpg', '78fd79c06.jpg', '792038159.jpg', '7963573a1.jpg', '7979e93cd.jpg', '79d9ff869.jpg', '79e309e7b.jpg', '79e6f2b42.jpg', '79ea45aa1.jpg', '7a1986428.jpg', '7a4e42374.jpg', '7a512ca2c.jpg', '7a5288cb8.jpg', '7add4314d.jpg', '7b0435807.jpg', '7b1ed2ad7.jpg', '7b3bb39d1.jpg', '7b455e37c.jpg', '7b8ac2c44.jpg', '7bed4da05.jpg', '7bfa422df.jpg', '7c1543f80.jpg', '7c46d8f79.jpg', '7c5534db1.jpg', '7cc1fb6ee.jpg', '7cccf944b.jpg', '7cd146e5e.jpg', '7cd86fd14.jpg', '7cda61a73.jpg', '7d62939af.jpg', '7dd7fc396.jpg', '7e104caad.jpg', '7e2c97697.jpg', '7e8904c22.jpg', '7eb199869.jpg', '7f1d3ec5e.jpg', '7f9ea512e.jpg', '80111d56e.jpg', '80657f706.jpg', '808359bda.jpg', '80cbe5d35.jpg', '80d489d3f.jpg', '80d4f7a25.jpg', '817d399e2.jpg', '8187f1b45.jpg', '81a5138eb.jpg', '81da020a0.jpg', '830ebda8b.jpg', '83325a620.jpg', '837f2703c.jpg', '83926cb04.jpg', '83a0dbb43.jpg', '83a187036.jpg', '83aa61a19.jpg', '846fff7a8.jpg', '8475899d7.jpg', '84e348664.jpg', '86d73c437.jpg', '86fe3cf8c.jpg', '874f5fe53.jpg', '87c5bbcba.jpg', '87f4645ee.jpg', '8827f75d2.jpg', '884488d16.jpg', '88afdeeb8.jpg', '88bfc04e8.jpg', '88cacaf33.jpg', '8973e4e91.jpg', '89977988b.jpg', '89a629daa.jpg', '8a5484d4d.jpg', '8b08c23f0.jpg', '8b197ff6f.jpg', '8bc3d26cb.jpg', '8bd6ef3fb.jpg', '8c50370fe.jpg', '8d40206b1.jpg', '8d5f997f2.jpg', '8d8bd106b.jpg', '8e1cf2257.jpg', '8e4dbe30f.jpg', '8e703053f.jpg', '8f26dbe33.jpg', '8f480a549.jpg', '8f502dacc.jpg', '8ff2bd9f3.jpg', '8ff37df24.jpg', '9056783d7.jpg', '90928cdb6.jpg', '911e86fb7.jpg', '9132d6f86.jpg', '91376eb04.jpg', '91604e4f4.jpg', '9177da79f.jpg', '91a32baec.jpg', '91ef23069.jpg', '92f506757.jpg', '943a908b4.jpg', '944afa4e4.jpg', '9484781db.jpg', '948f0cad1.jpg', '949a1d446.jpg', '94a687dea.jpg', '94b1d0288.jpg', '94c65ec76.jpg', '950487205.jpg', '9520225ec.jpg', '9553248f2.jpg', '95587f05e.jpg', '9568a10f7.jpg', '958feb050.jpg', '95aa55d7d.jpg', '95dca6ffa.jpg', '95eb51548.jpg', '9676c628e.jpg', '967ecac66.jpg', '96a864d9e.jpg', '96fefb723.jpg', '971cb01d4.jpg', '97880f512.jpg', '980d73519.jpg', '98861ce3b.jpg', '98bae0369.jpg', '98da1cdfd.jpg', '990852160.jpg', '9930cc99a.jpg', '9971b06fb.jpg', '99ced6e4a.jpg', '9aa6cf465.jpg', '9abf4e920.jpg', '9add1b7db.jpg', '9aec02d72.jpg', '9b16a82de.jpg', '9b5147492.jpg', '9b66b8330.jpg', '9c1af32c2.jpg', '9c595e23e.jpg', '9cbc700db.jpg', '9cc10ade1.jpg', '9cd461813.jpg', '9cebc2686.jpg', '9d143b20f.jpg', '9d2b4edf3.jpg', '9e24388bd.jpg', '9ebdc1f1f.jpg', '9f7498252.jpg', '9f7a5b38b.jpg', '9fcc459b7.jpg', '9fef81473.jpg', 'a02e9f525.jpg', 'a07c95dec.jpg', 'a0838ee79.jpg', 'a0b280324.jpg', 'a0c32332a.jpg', 'a0d37c784.jpg', 'a0fd8f9d6.jpg', 'a138d1604.jpg', 'a20204e10.jpg', 'a2423ec13.jpg', 'a269d58e3.jpg', 'a29360bc1.jpg', 'a301b86f5.jpg', 'a3849d778.jpg', 'a40c26912.jpg', 'a437f34dc.jpg', 'a44298fe1.jpg', 'a4a2f54f4.jpg', 'a4c9fb612.jpg', 'a4fe1adda.jpg', 'a521ed387.jpg', 'a55578b4c.jpg', 'a5a94ede7.jpg', 'a5e151ad8.jpg', 'a631d53aa.jpg', 'a69f95c48.jpg', 'a7377c95e.jpg', 'a79b53847.jpg', 'a7e803b17.jpg', 'a821909ee.jpg', 'a83fc096c.jpg', 'a8675325e.jpg', 'a873b638e.jpg', 'a8ab0eae9.jpg', 'a94261525.jpg', 'aa1d1e861.jpg', 'aa604ec06.jpg', 'ab3a9a988.jpg', 'ab730950d.jpg', 'ab7ad60ea.jpg', 'ab9d7104b.jpg', 'abb5bcc54.jpg', 'ac4eb0b7f.jpg', 'aca4c0bf2.jpg', 'acecbd93a.jpg', 'ad9471f70.jpg', 'ad9c71145.jpg', 'adab9d36c.jpg', 'add9aa6e6.jpg', 'ae15916ee.jpg', 'ae32bf450.jpg', 'ae3cf9bab.jpg', 'ae429576b.jpg', 'ae831607d.jpg', 'aea7d0dcf.jpg', 'afaafa0e2.jpg', 'afc3e3e90.jpg', 'afec9857d.jpg', 'b0050b626.jpg', 'b03b804f4.jpg', 'b069e70a9.jpg', 'b0b5a3357.jpg', 'b1166a68f.jpg', 'b1648ba07.jpg', 'b1b83ad86.jpg', 'b1c324193.jpg', 'b214b85d0.jpg', 'b2491c424.jpg', 'b2aea7a20.jpg', 'b2c7e1161.jpg', 'b2fae3494.jpg', 'b371745dc.jpg', 'b388c6de3.jpg', 'b3912fc50.jpg', 'b399d14c2.jpg', 'b3a766a95.jpg', 'b3f594ba3.jpg', 'b461a25f2.jpg', 'b4a113603.jpg', 'b4d365c88.jpg', 'b4dfd853c.jpg', 'b506c5877.jpg', 'b51cdf84f.jpg', 'b6427c1f5.jpg', 'b64844bed.jpg', 'b64f40c00.jpg', 'b6d419268.jpg', 'b6db2946b.jpg', 'b6edd61b7.jpg', 'b7018c2a5.jpg', 'b760debb1.jpg', 'b98946867.jpg', 'b991340c8.jpg', 'ba4168e4d.jpg', 'ba8ebb757.jpg', 'bb131c78e.jpg', 'bb13a714f.jpg', 'bb3ed626f.jpg', 'bb5322eae.jpg', 'bbc5bbff4.jpg', 'bbe2bd39d.jpg', 'bc34d04f1.jpg', 'bc6d00672.jpg', 'bc844c51a.jpg', 'bcc1fd0e4.jpg', 'bcf7d4b9a.jpg', 'bcf8c8739.jpg', 'bd96c3707.jpg', 'bd9de1aa3.jpg', 'bdb1f5a68.jpg', 'bddb8e7c7.jpg', 'be16b3bd7.jpg', 'be6f60f41.jpg', 'be76e9ca7.jpg', 'bee40f5e8.jpg', 'bf275fe13.jpg', 'bf537d326.jpg', 'c0473efc0.jpg', 'c090c3c13.jpg', 'c0bd7fecd.jpg', 'c1c3f9072.jpg', 'c1e1e7b0c.jpg', 'c224552e0.jpg', 'c234bf0a0.jpg', 'c2b52f420.jpg', 'c367c6133.jpg', 'c37e5676c.jpg', 'c3db04098.jpg', 'c3e859718.jpg', 'c3f9989d5.jpg', 'c43fd3530.jpg', 'c4405bef9.jpg', 'c4617b332.jpg', 'c4987c901.jpg', 'c50de1f31.jpg', 'c521ad2a6.jpg', 'c55581dff.jpg', 'c57bbee34.jpg', 'c5bd13a82.jpg', 'c66f8a343.jpg', 'c6bc7ca4b.jpg', 'c6f648543.jpg', 'c716d86d5.jpg', 'c723f1ada.jpg', 'c725bafda.jpg', 'c7335eee0.jpg', 'c759436cd.jpg', 'c8144de93.jpg', 'c82561e06.jpg', 'c8311ec86.jpg', 'c86f91dbf.jpg', 'c8f2d68aa.jpg', 'c91c10abe.jpg', 'c93217423.jpg', 'c96562a3f.jpg', 'c9737bd79.jpg', 'c9ca9769f.jpg', 'c9e2ce466.jpg', 'caf4103e1.jpg', 'cb17da791.jpg', 'cb241fa5d.jpg', 'cb28e4857.jpg', 'cba3fdc7a.jpg', 'cbb1d7ff5.jpg', 'cc069dc99.jpg', 'cc6e5e804.jpg', 'cc9ddbc17.jpg', 'ccb799c73.jpg', 'cd17f385a.jpg', 'cd75780c0.jpg', 'cde486dbf.jpg', 'cdfb634a5.jpg', 'ce1c08011.jpg', 'ce6170a7f.jpg', 'ce8b43c3f.jpg', 'cf0483836.jpg', 'cf06b295a.jpg', 'cf075fd69.jpg', 'd04a7fb6c.jpg', 'd0793e6b2.jpg', 'd0cee7515.jpg', 'd18e48954.jpg', 'd1ae5708a.jpg', 'd1b3aa6e7.jpg', 'd1d054d6f.jpg', 'd22364fb6.jpg', 'd249e6983.jpg', 'd25120582.jpg', 'd3801de15.jpg', 'd42853714.jpg', 'd42d5725e.jpg', 'd49ed89d0.jpg', 'd4a0cb9af.jpg', 'd4ac8538b.jpg', 'd5137b6f8.jpg', 'd52fefa0f.jpg', 'd5ae74330.jpg', 'd5bbdc8a8.jpg', 'd5e8bbe9a.jpg', 'd5fab51f7.jpg', 'd6128fbfc.jpg', 'd6377dc32.jpg', 'd6677e1ff.jpg', 'd670249ed.jpg', 'd67e52625.jpg', 'd6cba7ed9.jpg', 'd704ab756.jpg', 'd7741a3ba.jpg', 'd8129a060.jpg', 'd838ab96a.jpg', 'd866b5d5c.jpg', 'd8697da18.jpg', 'd8f8075c8.jpg', 'da6cce90a.jpg', 'da891d3af.jpg', 'da9942d06.jpg', 'dab41427c.jpg', 'dae47b14e.jpg', 'db6a9172c.jpg', 'db758d243.jpg', 'dbfc43562.jpg', 'dc2205ab2.jpg', 'dc89301ff.jpg', 'dc8d040ab.jpg', 'dd135f9ec.jpg', 'dd4531cef.jpg', 'dd9364137.jpg', 'ddca8eddd.jpg', 'de2df260c.jpg', 'de5881c2b.jpg', 'de7556be9.jpg', 'dec5aa06a.jpg', 'dedf68f1e.jpg', 'def7d77bd.jpg', 'defe590d5.jpg', 'df0facbbd.jpg', 'df6767e85.jpg', 'dfb1ab260.jpg', 'dfc265237.jpg', 'e01b0d22c.jpg', 'e07986242.jpg', 'e0b422958.jpg', 'e0d3ed478.jpg', 'e0f059688.jpg', 'e1090545d.jpg', 'e16b5476a.jpg', 'e237a3954.jpg', 'e30317c29.jpg', 'e30e861c8.jpg', 'e31cb8391.jpg', 'e380b37ba.jpg', 'e391fbf7c.jpg', 'e397fcb9c.jpg', 'e4168f460.jpg', 'e4612d7c4.jpg', 'e49ca4ccc.jpg', 'e4f7dd7de.jpg', 'e55cdcaaf.jpg', 'e57a18b8f.jpg', 'e5803c399.jpg', 'e5c133bf8.jpg', 'e5c597eca.jpg', 'e61b83be0.jpg', 'e62ab86cd.jpg', 'e7c0e2635.jpg', 'e80bc63e0.jpg', 'e83b28579.jpg', 'e89125653.jpg', 'e89a4ca99.jpg', 'e8a1e41ef.jpg', 'e8eefb79a.jpg', 'e904c0dc2.jpg', 'e968f8497.jpg', 'e9843e450.jpg', 'e9d339446.jpg', 'ea8c1f361.jpg', 'eab87e269.jpg', 'eacf21af0.jpg', 'ec0e63edf.jpg', 'ec1e848f0.jpg', 'ec44edc94.jpg', 'ec6132d16.jpg', 'ec6434bac.jpg', 'ec7ab4de4.jpg', 'ec96e3f18.jpg', 'ecdcdfc6d.jpg', 'ece52b68a.jpg', 'edfba47f3.jpg', 'ee047d59d.jpg', 'ee6666c5c.jpg', 'ef4b7c6be.jpg', 'ef5bd0f19.jpg', 'ef84d8825.jpg', 'ef8e8852a.jpg', 'ef963aadc.jpg', 'efb9face0.jpg', 'efc0006fa.jpg', 'f04c7c5ac.jpg', 'f0842d221.jpg', 'f0fa65d89.jpg', 'f1338af36.jpg', 'f14eb3bba.jpg', 'f1d90c01a.jpg', 'f1d98dffe.jpg', 'f1ff7d363.jpg', 'f2313afbd.jpg', 'f246790fc.jpg', 'f25152812.jpg', 'f3e31ebb4.jpg', 'f3e43b28e.jpg', 'f4ac9794b.jpg', 'f50a536c6.jpg', 'f550b3e1b.jpg', 'f605a77df.jpg', 'f625f93a1.jpg', 'f779cc81a.jpg', 'f7c7e853c.jpg', 'f7e741823.jpg', 'f7f2c2817.jpg', 'f80ed5101.jpg', 'f82d83496.jpg', 'f83e863db.jpg', 'f89ea01f9.jpg', 'f8e1d1d25.jpg', 'f947a5bf6.jpg', 'f948cddb2.jpg', 'f98450a9d.jpg', 'f99381ed5.jpg', 'f9a5b9bea.jpg', 'f9c2ebdcf.jpg', 'f9ccc4b77.jpg', 'f9d438665.jpg', 'fa2a43fe9.jpg', 'fa32469ab.jpg', 'fa52724c1.jpg', 'fa5900edc.jpg', 'fb47d1546.jpg', 'fb878c641.jpg', 'fb8870b74.jpg', 'fbca0c4fb.jpg', 'fc1a8fe78.jpg', 'fc1dae347.jpg', 'fc214bcbc.jpg', 'fc28f7fe0.jpg', 'fc3c8279e.jpg', 'fc3ec57fb.jpg', 'fc6ec9b13.jpg', 'fc9258351.jpg', 'fc9b9483f.jpg', 'fca5873cd.jpg', 'fcbff7cb3.jpg', 'fd63c350a.jpg', 'fe03f768e.jpg', 'fe3116441.jpg', 'fe7315df8.jpg', 'ff18d8aa8.jpg', 'ff4d29e0d.jpg', 'ffa10f6f3.jpg', 'ffaf13d96.jpg', 'ffbf79783.jpg', 'ffdb60677.jpg']

submission = pd.read_csv('data/sample_submission.csv')
submission['EncodedPixels'] = ''  # 7204


threshold = [0.5,0.5,0.5,0.5]
min_size = 200


for idx in range(final.shape[0]):

    preds = []
    for ch in range(4):
        if nonmissing_cls_output[idx][ch] == 0:
            preds.append('')
        else:
            preds.append(mask2rle(post_process(final[idx][ch], threshold=threshold[ch], min_size=min_size, fill_up=False)))

    submission.loc[submission['ImageId_ClassId'].apply(lambda x: x.split('_')[0]) == nonmissing_fnames[idx], 'EncodedPixels'] = preds
    # submission.loc[4*idx:4*(idx+1) - 1]['EncodedPixels'] = preds

submission.to_csv('fuck.csv', index=False)


df = pd.read_csv('fuck.csv')
counts = []

for i in range(4):
    df_cls = df.loc[df['ImageId_ClassId'].apply(lambda x: x.split('_')[1]) == str(i+1)].reset_index()

    count = 0
    for j in range(len(df_cls)):
        if not pd.isnull(df_cls['EncodedPixels'].loc[j]):
            count += 1

    counts.append(count)

print(counts)
